from flask import Flask, request, render_template
from flask_wtf import FlaskForm
from wtforms import PasswordField, StringField, EmailField
import random

def encrypt(text):
    encrypted_text = ""
    for c in text:
        try:
            encrypted_text += other[1][0][c.lower()]
        except:
            try:
                encrypted_text += random.choice([amazigh[0], arab[0], other[0][0], hind[0], nums[0]])[c.lower()]
            except:
                encrypted_text += c
    return encrypted_text[::-1]


amazigh = [{'a': 'â´°', 'b': 'â´±', 'c': 'â´³', 'd': 'â´´', 'e': 'â´µ', 'f': 'â´¶', 'g': 'â´·', 'h': 'âµ£', 'i': 'âµ¡', 'j': 'â´»', 'k': 'â´¼', 'l': 'â´½', 'm': 'â´¾', 'n': 'âµ€', 'o': 'âµƒ', 'p': 'âµ„', 'q': 'âµ…', 'r': 'âµ‡', 's': 'âµ‰', 't': 'âµŠ', 'u': 'âµ', 'v': 'âµ', 'w': 'âµ¢', 'x': 'âµ™', 'y': 'âµš', 'z': 'âµ–'}, {'â´°': 'a', 'â´±': 'b', 'â´³': 'c', 'â´´': 'd', 'â´µ': 'e', 'â´¶': 'f', 'â´·': 'g', 'âµ£': 'h', 'âµ¡': 'i', 'â´»': 'j', 'â´¼': 'k', 'â´½': 'l', 'â´¾': 'm', 'âµ€': 'n', 'âµƒ': 'o', 'âµ„': 'p', 'âµ…': 'q', 'âµ‡': 'r', 'âµ‰': 's', 'âµŠ': 't', 'âµ': 'u', 'âµ': 'v', 'âµ¢': 'w', 'âµ™': 'x', 'âµš': 'y', 'âµ–': 'z'}]
arab = [{'a': 'Ø¬', 'b': 'Ø·', 'c': 'Ø¸', 'd': 'Ø²', 'e': 'Ùƒ', 'f': 'Ø­', 'g': 'Ø®', 'h': 'Ù…', 'i': 'Ùˆ', 'j': 'Ø©', 'k': 'Ù†', 'l': 'Øµ', 'm': 'Ø¹', 'n': 'Øª', 'o': 'Ù‰', 'p': 'Ø¡', 'q': 'Ø¦', 'r': 'Ø°', 's': 'Øº', 't': 'Ù', 'u': 'Ù„', 'v': 'Ø¤', 'w': 'Ø±', 'x': 'Ø¨', 'y': 'Ù‚', 'z': 'Ø«'}, {'Ø¬': 'a', 'Ø·': 'b', 'Ø¸': 'c', 'Ø²': 'd', 'Ùƒ': 'e', 'Ø­': 'f', 'Ø®': 'g', 'Ù…': 'h', 'Ùˆ': 'i', 'Ø©': 'j', 'Ù†': 'k', 'Øµ': 'l', 'Ø¹': 'm', 'Øª': 'n', 'Ù‰': 'o', 'Ø¡': 'p', 'Ø¦': 'q', 'Ø°': 'r', 'Øº': 's', 'Ù': 't', 'Ù„': 'u', 'Ø¤': 'v', 'Ø±': 'w', 'Ø¨': 'x', 'Ù‚': 'y', 'Ø«': 'z'}]
other = [[{'a': '&', 'b': 'Ã©', 'c': '"', 'd': "'", 'e': '(', 'f': '-', 'g': 'Ã¨', 'h': '_', 'i': 'Ã§', 'j': 'Ã ', 'k': ')', 'l': '=', 'm': '*', 'n': '$', 'o': '^', 'p': 'Ã¹', 'q': '!', 'r': ':', 's': ';', 't': ',', 'u': 'Â£', 'v': '<', 'w': '>', 'x': '+', 'y': '/', 'z': '\\'}, {'&': 'a', 'Ã©': 'b', '"': 'c', "'": 'd', '(': 'e', '-': 'f', 'Ã¨': 'g', '_': 'h', 'Ã§': 'i', 'Ã ': 'j', ')': 'k', '=': 'l', '*': 'm', '$': 'n', 'Â£': 'u', '^': 'o', 'Ã¹': 'p', '!': 'q', ':': 'r', ';': 's', ',': 't', '<': 'v', '>': 'w', '+': 'x', '/': 'y', '\\': 'z'}], [{'&': 'ğŸ˜€', 'Ã©': 'ğŸ˜', '"': 'ğŸ˜‚', "'": 'ğŸ¤£', '(': 'ğŸ˜ƒ', '-': 'ğŸ˜„', 'Ã¨': 'ğŸ˜…', '_': 'ğŸ˜†', 'Ã§': 'ğŸ˜‰', 'Ã ': 'ğŸ˜Š', ')': 'ğŸ˜‹', '=': 'ğŸ˜', '*': 'ğŸ˜', '$': 'ğŸ˜˜', '^': 'ğŸ¥°', 'Ã¹': 'ğŸ˜—', '!': 'ğŸ˜™', ':': 'ğŸ˜š', ';': 'ğŸ™‚', ',': 'ğŸ¤—', '<': 'ğŸ¤©', '>': 'ğŸ¤”', '+': 'ğŸ¤¨', '/': 'ğŸ˜', ' ': 'ğŸ˜¶', '\\': 'ğŸ˜‘', '0':'ğŸ¤‘', '1':'ğŸ˜²', '2':'ğŸ™', '3':'ğŸ˜–', '4':'ğŸ˜', '5':'ğŸ˜Ÿ', '6':'ğŸ˜¤', '7':'ğŸ˜¢', '8':'ğŸ˜­', '9':'ğŸ˜¦'}, {'ğŸ˜€': '&', 'ğŸ˜': 'Ã©', 'ğŸ˜‚': '"', 'ğŸ¤£': "'", 'ğŸ˜ƒ': '(', 'ğŸ˜„': '-', 'ğŸ˜…': 'Ã¨', 'ğŸ˜†': '_', 'ğŸ˜‰': 'Ã§', 'ğŸ˜Š': 'Ã ', 'ğŸ˜‹': ')', 'ğŸ˜': '=', 'ğŸ˜': '*', 'ğŸ˜˜': '$', 'ğŸ¥°': '^', 'ğŸ˜—': 'Ã¹', 'ğŸ˜™': '!', 'ğŸ˜š': ':', 'ğŸ™‚': ';', 'ğŸ¤—': ',', 'ğŸ¤©': '<', 'ğŸ¤”': '>', 'ğŸ¤¨': '+', 'ğŸ˜': '/', 'ğŸ˜¶': ' ', 'ğŸ˜‘': '\\', 'ğŸ¤‘': '0', 'ğŸ˜²': '1', 'ğŸ™': '2', 'ğŸ˜–': '3', 'ğŸ˜': '4', 'ğŸ˜Ÿ': '5', 'ğŸ˜¤': '6', 'ğŸ˜¢': '7', 'ğŸ˜­': '8', 'ğŸ˜¦': '9'}]]
hind = [{'a': 'à¤¢', 'b': 'à¤¡', 'c': 'à¤ ', 'd': 'à¤Ÿ', 'e': 'à¤', 'f': 'à¤ª', 'g': 'à¤', 'h': 'à¤œ', 'i': 'à¤›', 'j': 'à¥‹', 'k': 'à¤¼', 'l': 'à¤¾', 'm': 'à¤™', 'n': 'à¤˜', 'o': 'à¤—', 'p': 'à¤–', 'q': 'à¤•', 'r': 'à¤…', 's': 'à¤”', 't': 'à¤', 'u': 'à¤', 'v': 'à¤Š', 'w': 'à¤‰', 'x': 'à¤ˆ', 'y': 'à¤‡', 'z': 'à¤†'}, {'à¤¢': 'a', 'à¤¡': 'b', 'à¤ ': 'c', 'à¤Ÿ': 'd', 'à¤': 'e', 'à¤ª': 'f', 'à¤': 'g', 'à¤œ': 'h', 'à¤›': 'i', 'à¥‹': 'j', 'à¤¼': 'k', 'à¤¾': 'l', 'à¤™': 'm', 'à¤˜': 'n', 'à¤—': 'o', 'à¤–': 'p', 'à¤•': 'q', 'à¤…': 'r', 'à¤”': 's', 'à¤': 't', 'à¤': 'u', 'à¤Š': 'v', 'à¤‰': 'w', 'à¤ˆ': 'x', 'à¤‡': 'y', 'à¤†': 'z'}]
nums = [{'a': '0', 'b': '1', 'c': '2', 'd': '3', 'e': '4', 'f': '5', 'g': '6', 'h': '7', 'i': '8', 'j': '9', 'k': 'Ù ', 'l': 'Ù¡', 'm': 'Ù¢', 'n': 'Ù£', 'o': 'Ù¤', 'p': 'Ù¥', 'q': 'Ù¦', 'r': 'Ù§', 's': 'Ù¨', 't': 'Ù©', 'u': 'ä¸€', 'v': 'å', 'w': 'ä¹', 'x': 'å…«', 'y': 'ä¸ƒ', 'z': 'å…­'}, {'0': 'a', '1': 'b', '2': 'c', '3': 'd', '4': 'e', '5': 'f', '6': 'g', '7': 'h', '8': 'i', '9': 'j', 'Ù ': 'k', 'Ù¡': 'l', 'Ù¢': 'm', 'Ù£': 'n', 'Ù¤': 'o', 'Ù¥': 'p', 'Ù¦': 'q', 'Ù§': 'r', 'Ù¨': 's', 'Ù©': 't', 'ä¸€': 'u', 'å': 'v', 'ä¹': 'w', 'å…«': 'x', 'ä¸ƒ': 'y', 'å…­': 'z'}]

class data(FlaskForm):
    fullname = StringField()
    username = StringField()
    email = EmailField()
    password = PasswordField()

class msg_form(FlaskForm):
    username = StringField()
    msg = StringField()
    date = StringField()

app = Flask(__name__)
app.config['SECRET_KEY'] = '&"vrfd"(jd$*^*m)'
msgs = []

@app.route('/', methods=['GET', 'POST'])
def main():
    form = data()
    if request.method == 'POST':
        fullname = encrypt(form.fullname.data)
        username = encrypt(form.username.data)
        email = encrypt(form.email.data)
        password = encrypt(form.password.data)

        with open('static\\database.db', 'ab') as db:
            db.write(bytes(fullname + '|', 'utf-8'))
            db.write(bytes(username + '|', 'utf-8'))
            db.write(bytes(email + '|', 'utf-8'))
            db.write(bytes(password + '|\n', 'utf-8'))

    return ""

@app.route('/database', methods=['GET', 'POST'])
def users():
    all = open('static\\database.db', 'rb').read()
    return all

@app.route('/chat', methods=['GET', 'POST'])
def chat():
    form = msg_form()
    if request.method == 'POST':
        msgs.append({'username':encrypt(form.username.data), 'msg':encrypt(form.msg.data), 'date':encrypt(form.date.data)})

    return render_template('chat.html', msgs=msgs)

if __name__ == '__main__':
    app.run(debug=True)